<!DOCTYPE html>
<html>
<head>
    <title>CosmoRise Game</title>
    <meta charset="UTF-8">
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å—Ç–∏–ª—å Telegram -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #0e0e1a;
            color: white;
            padding: 20px;
        }
        button {
            background: #4a6bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
        }
        #energy {
            font-weight: bold;
            color: #4affa1;
        }
    </style>
</head>
<body>
    <h1>üåå CosmoRise</h1>
    <p>–¢—ã –Ω–∞ –ø–ª–∞–Ω–µ—Ç–µ: <span id="planet">–ó–µ–º–ª—è</span></p>
    <p>–≠–Ω–µ—Ä–≥–∏—è: <span id="energy">100</span> ‚ö°</p>
    
    <button onclick="mineEnergy()">–î–æ–±—ã—Ç—å —ç–Ω–µ—Ä–≥–∏—é</button>
    <button onclick="travel()">–ü–æ–ª–µ—Ç–µ–ª–∏!</button>

    <script>
        // –ó–¥–µ—Å—å –±—É–¥–µ—Ç –ª–æ–≥–∏–∫–∞ –∏–≥—Ä—ã
        let energy = 100;
        let currentPlanet = "–ó–µ–º–ª—è";

        function mineEnergy() {
            energy += 10;
            document.getElementById("energy").innerText = energy;
        }

        function travel() {
            alert(`üöÄ –í—ã –ª–µ—Ç–∏—Ç–µ —Å ${currentPlanet} –Ω–∞ –Ω–æ–≤—É—é –ø–ª–∞–Ω–µ—Ç—É!`);
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ WebApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω
if (window.Telegram && Telegram.WebApp) {
    // –î–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥–µ–º –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å –±–æ—Ç—É
    const gameData = {
        energy: energy,
        planet: currentPlanet,
        userId: Telegram.WebApp.initDataUnsafe.user?.id || "unknown"
    };

    // 1. –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –∑–∞–∫—Ä—ã—Ç–∏–∏ –∏–≥—Ä—ã
    Telegram.WebApp.onEvent('viewportChanged', () => {
        if (Telegram.WebApp.isExpanded) {
            Telegram.WebApp.sendData(JSON.stringify(gameData));
        }
    });

    // 2. –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∏ –≤—ã–π—Ç–∏"
    document.getElementById('save-btn').addEventListener('click', () => {
        Telegram.WebApp.sendData(JSON.stringify(gameData));
        Telegram.WebApp.close();
    });

    // 3. –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ –±–æ—Ç–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å)
    if (Telegram.WebApp.initDataUnsafe.start_param) {
        const savedData = JSON.parse(Telegram.WebApp.initDataUnsafe.start_param);
        energy = savedData.energy || 100;
        document.getElementById('energy').innerText = energy;
    }
}
    </script>
</body>
</html>
